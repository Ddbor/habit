"use strict";(self.webpackChunk_ddbor_habit=self.webpackChunk_ddbor_habit||[]).push([[625],{69517:function(Lt,Ee,d){d.r(Ee),d.d(Ee,{HabitColumnSetting:function(){return St},HabitDragSortTable:function(){return Vt},HabitMultipleSelect:function(){return kt},HabitRangePicker:function(){return et},HabitTimeSelecto:function(){return Gt},HabitWeekTimeSelecto:function(){return Wt},arrayMoveImmutable:function(){return ve},arrayMoveMutable:function(){return Le},deepFindItem:function(){return Ye},groupHabitColumns:function(){return Pe},habitColumnsCopy:function(){return Q},habitSortColumns:function(){return _},sortGroupHabitColumns:function(){return Ke}});var Ue=d(57213),v=d.n(Ue),Je=d(54306),D=d.n(Je),Xe=d(28001),De=d(7553),U=d(54223),pe=d(16328),qe=d(58290),we=d(71583),Ae=d(17852),c=d(85170),_e=d(74637),B=d.n(_e),t=d(43010),xe=function(){return[{label:"\u4ECA\u65E5",value:[B()(),B()()]},{label:"\u6628\u65E5",value:[B()().subtract(1,"d"),B()().subtract(1,"d")]}]},et=function(e){var n=e.value,a=e.popoverProps,r=e.buttonProps,o=e.presetsButtonProps,s=e.subtmitButtonProps,i=e.cancelButtonProps,u=e.presets,m=e.startDatePickerProps,b=e.endDatePickerProps,p=e.format,x=p===void 0?"YYYY-MM-DD":p,y=e.compared,j=e.onChange,h=(0,c.useState)(["",""]),C=D()(h,2),f=C[0],S=C[1],k=(0,c.useState)(n),F=D()(k,2),A=F[0],M=F[1],Y=(0,c.useState)(["",""]),W=D()(Y,2),$=W[0],G=W[1],T=(0,c.useState)(!1),H=D()(T,2),Z=H[0],N=H[1],O=(0,c.useMemo)(function(){return typeof y=="boolean"},[y]),he=(0,c.useState)(""),fe=D()(he,2),ee=fe[0],me=fe[1],re=(0,c.useState)(!1),ge=D()(re,2),L=ge[0],ae=ge[1];(0,c.useEffect)(function(){ae(O?y:null)},[y,O]);var Se=(0,c.useMemo)(function(){return O&&!y},[O,y]),oe=(0,c.useMemo)(function(){return O&&!L},[O,L]),ke=(0,c.useMemo)(function(){return Z?180:0},[Z]),X=(0,c.useMemo)(function(){var g,I;if(O){var z,Ne;return[((z=xe().find(function(te){return B()(te.value[0]).isSame(n[0],"d")}))===null||z===void 0?void 0:z.label)||f[0],Se?"":((Ne=xe().find(function(te){return B()(te.value[0]).isSame(n[1],"d")}))===null||Ne===void 0?void 0:Ne.label)||f[1]]}if(ee)return[ee,""];var Qe=(g=u||[])===null||g===void 0||(I=g.concat(xe()).find(function(te){return B()(te.value[0]).isSame(n[0],"d")&&B()(te.value[1]).isSame(n[1],"d")}))===null||I===void 0?void 0:I.label;return[Qe||f[0],Qe?"":f[1]]},[n,u,Se,O,f,ee]),P=(0,c.useMemo)(function(){return{textAlign:X[1]?"center":"left"}},[X]),w=(0,c.useCallback)(function(g){return g?oe?g>B()().endOf("d"):L?g>B()().endOf("d")||A[1]&&g.isSame(A[1],"d"):A[1]&&g>A[1]:!1},[A[1],oe]),R=(0,c.useCallback)(function(g){return g?L?g>B()().endOf("d"):A[0]&&g<A[0]||g>B()().endOf("d"):!1},[A[0],L]);(0,c.useEffect)(function(){M(n);var g=[B()(n[0]).format(x),B()(n[1]).format(x)];S(g),G(g)},[n]);var K=function(I,z){M([I,A[1]]),G([z,$[1]])},V=function(I,z){M([A[0],I]),G([$[0],z])},E=function(I){r!=null&&r.disabled?N(!1):N(I)},q=function(){N(!1),j==null||j(A,$,L),me(null)},se=function(I){M(I.value);var z=[B()(I.value[0]).format(x),B()(I.value[1]).format(x)];G(z),N(!1),j==null||j(I.value,z,L),me(I==null?void 0:I.label)},ie=(0,c.useCallback)(function(){return u==null?void 0:u.map(function(g,I){return typeof g.label=="string"?(0,t.jsx)("div",{className:"habit-range-picker-popover-presets-item",children:(0,t.jsx)(U.ZP,v()(v()({type:"link",size:"small",style:{padding:0,textAlign:"left",width:"100%"},onClick:function(){return se(g)}},o),{},{children:g.label}))},I):g.label})},[u]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(pe.Z,v()(v()({trigger:"click",placement:"bottom",open:Z,getPopupContainer:function(I){return I},overlayInnerStyle:{padding:0}},a),{},{onOpenChange:E,content:(0,t.jsxs)("div",{className:"habit-range-picker-popover-content",children:[(0,t.jsxs)("div",{className:"habit-range-picker-popover-head",children:[(0,t.jsxs)("div",{className:"habit-range-picker-popover-head-title",children:[(0,t.jsx)("div",{children:"\u9009\u62E9\u65E5\u671F:"}),O&&(0,t.jsxs)("div",{className:"habit-range-picker-popover-head-switch",children:[(0,t.jsx)("span",{children:"\u5BF9\u6BD4"}),(0,t.jsx)(qe.Z,{size:"small",checked:!!L,onChange:function(I){return ae(I)}})]})]}),(0,t.jsxs)("div",{className:"habit-range-picker-popover-date",children:[(0,t.jsx)(we.Z,v()({showToday:!1,allowClear:!1,size:"small",value:A[0],disabledDate:w,onChange:K},m)),(0,t.jsx)("span",{className:"habit-range-picker-popover-date-separator",children:"-"}),(0,t.jsx)(we.Z,v()(v()({showToday:!1,allowClear:!1,size:"small",placement:"bottomRight",value:A[1],disabledDate:R,onChange:V},b),{},{disabled:oe}))]})]}),(0,t.jsx)(Ae.Z,{style:{margin:0}}),u&&u.length&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"habit-range-picker-popover-presets",children:[(0,t.jsx)("div",{className:"habit-range-picker-popover-presets-title",children:"\u5FEB\u6377\u65E5\u671F:"}),(0,t.jsx)("div",{className:"habit-range-picker-popover-presets-list",children:ie()})]}),(0,t.jsx)(Ae.Z,{style:{margin:0}})]}),(0,t.jsxs)("div",{className:"habit-range-picker-popover-footer",children:[(0,t.jsx)(U.ZP,v()(v()({size:"small"},i),{},{style:{marginRight:"8px"},onClick:function(){return N(!1)},children:"\u53D6\u6D88"})),(0,t.jsx)(U.ZP,v()(v()({type:"primary",size:"small"},s),{},{onClick:function(){return q()},children:"\u786E\u5B9A"}))]})]}),children:(0,t.jsx)("div",{className:"habit-range-picker",children:(0,t.jsx)(U.ZP,v()(v()({},r),{},{onClick:function(){return N(!Z)},children:(0,t.jsxs)("div",{className:"habit-range-picker-button",children:[(0,t.jsx)(Xe.Z,{style:{color:"#999"}}),(0,t.jsxs)("div",{className:"habit-range-picker-button-text",children:[(0,t.jsx)("span",{className:"habit-range-picker-button-text-item",style:P,children:X[0]}),X[1]&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"habit-range-picker-button-text-separator",children:O?"\u5BF9\u6BD4":"-"}),(0,t.jsx)("span",{className:"habit-range-picker-button-text-item",style:P,children:X[1]})]})]}),(0,t.jsx)(De.Z,{style:{color:"#999",transform:"rotate(".concat(ke,"deg)"),transition:"all 0.3s"}})]})}))})}))})},tt=d(25359),le=d.n(tt),nt=d(49811),Te=d.n(nt),rt=d(12342),be=d.n(rt),Ie=d(71953),Fe=d(75445),at=d(8505),ot=d(49070),Oe=d(59282),ye=d(94986),Pe=function(e){return e.reduce(function(n,a){var r=a.properties.groupName,o=a.properties.groupOrder;return n[r]||(n[r]={groupName:r,groupOrder:o,columns:[]}),n[r].columns.push(a),n},{})},Ke=function(e){return Object.values(Pe(e)).sort(function(n,a){return n.groupOrder-a.groupOrder})},Ze=function(e){return typeof e.order=="number"?e.order:1/0},_=function(e){return e.filter(function(n){return n.show}).sort(function(n,a){return Ze(n)-Ze(a)})},Q=function(e){return e.map(function(n){return v()({},n)})},st=(0,Oe.W8)(function(l){var e=l.value;return(0,t.jsx)("div",{className:"habit-column-setting-drag-item",style:{backgroundImage:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAUCAYAAACEYr13AAAAt0lEQVR4Ae3BQQ3EMAxE0d8MDRMKEUtGFMlESig0RtoiaA697ntXVU3bzUNSrrVuXlTVtN08JOWw3UAAYbs5sN1AAGG7Bx8NSQlsYEtKDiQlsIEtKfnjqqppu3lIyrXWzYuqmrabh6QcthsIIGw3B7YbCCBs9+CjISmBDWxJyYGkBDawJSV/XFU1bTcPSbnWunlRVdN285CUw3YDAYTt5sB2AwGE7R58NCQlsIEtKTmQlMAGtqT8AT13ZKKS1qIVAAAAAElFTkSuQmCC")'},children:(0,t.jsx)(t.Fragment,{children:e==null?void 0:e.title})})}),it=(0,Oe.JN)(function(l){var e=l.children;return(0,t.jsx)("div",{className:"habit-column-setting-drag-box",children:e})}),lt=function(e){var n=e.dataSource,a=e.onSortEnd,r=(0,ye.J)(function(o){var s=o.oldIndex,i=o.newIndex;if(s!==i){var u=ve({array:Q(n),fromIndex:s,toIndex:i});u.forEach(function(m,b){m.order=b}),a==null||a(u)}});return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(it,{lockAxis:"y",lockToContainerEdges:!0,onSortEnd:r,children:n.map(function(o,s){return(0,t.jsx)(st,{index:s,value:o},o.key)})})})},ue=d(31762),ut=d(89058),ct={color:"#ccc",cursor:"pointer",fontSize:"14px",marginLeft:"2px",verticalAlign:"middle"},Be=function(e){return e.every(function(n){return n.show})},dt=function(e){return e.some(function(n){return n.show})&&!Be(e)},vt=function(e,n){return!n||typeof e!="string"?!1:e.includes(n)},ht=function(e){var n=e.dataSource,a=e.filterTitle,r=e.max,o=r===void 0?1/0:r,s=e.sortColumns,i=s===void 0?[]:s,u=e.onChange,m=(0,c.useState)([]),b=D()(m,2),p=b[0],x=b[1],y=(0,c.useMemo)(function(){return i.length>=o},[o,i]);(0,c.useEffect)(function(){x(Ke(Q(n)))},[n]);var j=function(C,f){var S=C.target.checked,k=Q(n),F=i.length;f.forEach(function(A){if(!(S&&F>=o||A!=null&&A.disable)){var M=k.findIndex(function(Y){return Y.key===A.key});k[M].show=S,S?F++:delete k[M].order}}),u==null||u(k)};return(0,t.jsx)(t.Fragment,{children:p.map(function(h,C){return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"habit-column-setting-left-cont-title",children:(0,t.jsx)(ue.Z,{indeterminate:dt(h.columns),checked:Be(h.columns),onChange:function(S){return j(S,h.columns)},children:(0,t.jsx)("span",{className:"habit-column-setting-checkbox-label",children:h.groupName})})}),(0,t.jsx)("div",{className:"habit-column-setting-checkbox-list clearfix",children:h.columns.map(function(f){return(0,t.jsxs)("div",{className:"habit-column-setting-checkbox-item ".concat(vt(f.title,a)?"habit-column-setting-checkbox-item-active":""),children:[(0,t.jsx)(ue.Z,{checked:f.show,disabled:f.disable||y&&!f.show,onChange:function(k){return j(k,[f])},children:(0,t.jsx)("span",{className:"habit-column-setting-checkbox-label",children:f==null?void 0:f.title})}),f.description&&(0,t.jsx)(pe.Z,{content:f.description,overlayInnerStyle:{maxWidth:200},children:(0,t.jsx)(ut.Z,{style:ct})})]},f.key)})})]},C.toString())})})},He=d(75736),ft=["columns","open","max","min","onOk","persistenceKey","persistenceType","extraContent"],mt=Ie.Z.Search,gt=Fe.Z.useToken,St=function(e){var n=e.columns,a=e.open,r=e.max,o=e.min,s=o===void 0?1:o,i=e.onOk,u=e.persistenceKey,m=e.persistenceType,b=e.extraContent,p=be()(e,ft),x=p.onClose,y=(0,c.useState)([]),j=D()(y,2),h=j[0],C=j[1],f=(0,c.useState)([]),S=D()(f,2),k=S[0],F=S[1],A=(0,c.useState)(""),M=D()(A,2),Y=M[0],W=M[1],$=(0,c.useRef)([]),G=(0,c.useState)(!0),T=D()(G,2),H=T[0],Z=T[1],N=(0,c.useMemo)(function(){return!u||!m||typeof window=="undefined"},[u,m]),O=gt(),he=O.token,fe=(0,c.useState)(!1),ee=D()(fe,2),me=ee[0],re=ee[1],ge=(0,c.useCallback)(function(P){if(N)return P;var w=window[m];try{var R=w==null?void 0:w.getItem(u);if(R){var K=JSON.parse(R),V=Q(P);return V.forEach(function(E){var q,se,ie,g;E.show=(q=K==null||(se=K[E.key])===null||se===void 0?void 0:se.show)!==null&&q!==void 0?q:E.show,E.order=(ie=K==null||(g=K[E.key])===null||g===void 0?void 0:g.order)!==null&&ie!==void 0?ie:E.order}),V}}catch(E){console.warn(E)}return P},[u,m,N]),L=(0,c.useCallback)(function(P){if(!N){var w=window[m];try{var R=P.reduce(function(K,V){return K[V.key]={show:V.show,order:V.order},K},{});w==null||w.setItem(u,JSON.stringify(R))}catch(K){console.warn(K)}}},[u,m,N]),ae=function(w,R){return w.map(function(K){var V=R.find(function(q){return q.key===K.key}),E=v()(v()({},K),{},{show:!!V});return V&&(E.order=V.order),E})};(0,c.useEffect)(function(){if(a){var P=n;$.current=P,Z(!1),C(_(Q($.current))),F($.current)}},[a,n]),(0,c.useEffect)(function(){if(!a&&H&&!N){var P=ge(n);Z(!1),i==null||i(ae(P,_(Q(P))))}},[H,N,a,n]);var Se=function(w){W(w)},oe=function(w){C(_(w)),F(w)},ke=function(){var w=Q($.current);w.forEach(function(R){R.disable||(R.show=!1,delete R.order)}),C(_(w)),F(w)},X=function(){var P=Te()(le()().mark(function w(R){var K;return le()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(typeof s=="number"&&h.length<s)){E.next=3;break}return re(!0),E.abrupt("return");case 3:if(!(typeof r=="number"&&h.length>r)){E.next=6;break}return re(!0),E.abrupt("return");case 6:return K=ae($.current,h),re(!1),L(K),E.next=11,i==null?void 0:i(K);case 11:if(E.t0=E.sent,E.t0===!1){E.next=14;break}x==null||x(R);case 14:case"end":return E.stop()}},w)}));return function(R){return P.apply(this,arguments)}}();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(at.Z,v()(v()({title:"\u9009\u62E9\u6570\u636E\u5B57\u6BB5",placement:"right",width:1e3,bodyStyle:{padding:"16px 24px",backgroundColor:"#f9f9f9"},footer:(0,t.jsxs)(ot.Z,{children:[(0,t.jsx)(U.ZP,{type:"default",onClick:x,children:"\u53D6\u6D88"}),(0,t.jsx)(U.ZP,{type:"primary",onClick:X,children:"\u786E\u5B9A"}),me&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(He.Z,{style:{color:he.colorError,fontSize:12}}),(0,t.jsxs)("span",{style:{color:he.colorError,fontSize:12},children:["\u8BF7",typeof s=="number"?"\u81F3\u5C11\u9009\u62E9 ".concat(s," \u4E2A\u6307\u6807"):"",typeof s=="number"&&typeof r=="number"&&"\uFF0C",typeof r=="number"?"\u81F3\u591A\u9009\u62E9 ".concat(r," \u4E2A\u6307\u6807"):""]})]})]}),open:a},p),{},{children:(0,t.jsxs)("div",{className:"habit-column-setting-body",children:[(0,t.jsxs)("div",{className:"habit-column-setting-left",children:[(0,t.jsx)("div",{className:"habit-column-setting-left-head",children:(0,t.jsx)(mt,{placeholder:"\u641C\u7D22\u6570\u636E\u5B57\u6BB5",allowClear:!0,style:{width:200},onSearch:Se})}),(0,t.jsx)("div",{className:"habit-column-setting-left-cont",children:(0,t.jsx)(ht,{max:r,sortColumns:h,dataSource:k,filterTitle:Y,onChange:oe})})]}),(0,t.jsxs)("div",{className:"habit-column-setting-right",children:[(0,t.jsxs)("div",{className:"habit-column-setting-right-head",children:[(0,t.jsxs)("span",{className:"habit-column-setting-checkbox-label",children:["\u5DF2\u9009\uFF08",h.length,r?" / ".concat(r):null,"\uFF09\u9879"]}),(0,t.jsx)("a",{className:"habit-column-setting-right-a",onClick:ke,children:"\u6E05\u7A7A"}),b]}),(0,t.jsx)("div",{className:"habit-column-setting-right-alert",children:"\u62D6\u52A8\u4EE5\u4E0B\u5B57\u6BB5\u8FDB\u884C\u6392\u5E8F"}),(0,t.jsx)(lt,{dataSource:h,onSortEnd:function(w){return C(_(w))}})]})]})}))})},pt=d(53911),xt=d(55457),bt=d(79131),yt=d(21503),Ct=Ie.Z.Search,jt=Fe.Z.useToken,kt=function(e){var n=e.popoverProps,a=e.buttonProps,r=e.searchProps,o=e.className,s=e.value,i=e.style,u=e.onChange,m=e.options,b=m===void 0?[]:m,p=e.buttonText,x=e.showSearch,y=x===void 0?!0:x,j=(0,c.useState)(!1),h=D()(j,2),C=h[0],f=h[1],S=(0,c.useState)(""),k=D()(S,2),F=k[0],A=k[1],M=(0,c.useMemo)(function(){return b.filter(function(N){return N.label.includes(F)})},[F,b]),Y=(0,c.useState)(!1),W=D()(Y,2),$=W[0],G=W[1],T=jt(),H=T.token,Z={color:H.colorTextQuaternary,fontSize:H.fontSizeIcon};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(pe.Z,v()(v()({open:C,onOpenChange:f,placement:"bottom",trigger:"click",overlayStyle:{width:250}},n),{},{content:(0,t.jsxs)(t.Fragment,{children:[!!y&&(0,t.jsx)(Ct,v()(v()({placeholder:"\u540D\u79F0\u641C\u7D22",className:"habit-multiple-select-search",allowClear:!0,size:"small"},r),{},{value:F,onChange:function(O){return A(O.target.value)}})),(0,t.jsx)(ue.Z.Group,{value:s,onChange:u,children:(0,t.jsx)(pt.Z,{gutter:[0,10],children:M.map(function(N){return(0,t.jsx)(xt.Z,{span:24,children:(0,t.jsx)(ue.Z,{value:N.value,children:N.label})},N.value)})})}),!M.length&&(0,t.jsx)(bt.Z,{description:!1})]}),children:(0,t.jsx)(U.ZP,v()(v()({className:"habit-multiple-select-button ".concat(o),style:i},a),{},{onMouseEnter:function(){return G(!0)},onMouseLeave:function(){return G(!1)},children:(0,t.jsxs)("div",{className:"habit-multiple-select-button-content",children:[(0,t.jsx)("span",{children:p}),s!=null&&s.length?$?(0,t.jsx)(He.Z,{className:"habit-multiple-select-icon",style:Z,onClick:function(O){O.stopPropagation(),u==null||u([])}}):(0,t.jsx)(yt.Z,{className:"habit-multiple-select-icon",count:s==null?void 0:s.length,showZero:!0,size:"small",color:H.colorPrimary}):(0,t.jsx)(De.Z,{className:"habit-multiple-select-icon",style:Z})]})}))}))})},Nt=d(65854),Ce=d.n(Nt),Et=d(43014),Dt=d(46996),J=d(87966),je=d(41485),wt=d(40202),At=function l(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"children",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"treeKey",r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];return e.forEach(function(o){o[a]&&r.push(o[a]),Array.isArray(o[n])&&l(o[n],n,a,r)}),r},Tt=function(e,n,a){var r=[n.id,a.id].map(function(m){return m.toString().split("-")}),o=D()(r,2),s=o[0],i=o[1];if(s.length===i.length&&s.length===1){var u=ve({array:e,fromIndex:parseInt(s[0]),toIndex:parseInt(i[0])});return{data:u,status:!0}}return{data:e,status:!1}},ce=function(e,n,a){return e.reduce(function(r,o){return Array.isArray(r)?r[Number(o)]:r[a][Number(o)]},n)},de=function(e,n,a,r){var o=[n.id,a.id].map(function(x){return x.toString().split("-")}),s=D()(o,2),i=s[0],u=s[1],m=i.pop(),b=u.pop();if(i.length!==u.length||!i.length||i.join(",")!==u.join(","))return{data:e,status:!1};var p=ce(i,e,r);return p[r]=ve({array:p[r],fromIndex:parseInt(m),toIndex:parseInt(b)}),{data:e,status:!0}},It=d(93525),ne=d.n(It),Ft=function(e,n){for(var a=!1,r=0;r<e.length;r++){var o=e[r],s=n[r];if(o!==s)if(typeof s=="undefined"||o>s){a=!0;break}else{a=!1;break}}return a?"up":"down"},Me=function(e,n,a){var r=ne()(n),o=parseInt(r.pop());if(!r.length)e.splice(o,1);else{var s=ce(r,e,a);s[a].splice(o,1)}},Re=function(e,n,a,r,o){var s=ne()(n),i=parseInt(s.pop());if(o==="down"&&(i+=1),!s.length)e.splice(i,0,r);else{var u=ce(s,e,a);u[a].splice(i,0,r)}},$e=function(e,n,a,r){var o=ne()(e),s=ce(n,e,r),i=Ft(n,a);return i==="up"?(Me(o,n,r),Re(o,a,r,s,i)):(Re(o,a,r,s,i),Me(o,n,r)),o},Ot=function(e,n,a,r){var o=de(e,n,a,r);if(o.status)return o;var s=de(e,n,a,r);if(s.status)return s;var i=[n.id,a.id].map(function(p){return p.toString().split("-")}),u=D()(i,2),m=u[0],b=u[1];return{data:$e(e,m,b,r),status:!0}},Pt=function(e,n,a,r){var o=de(e,n,a,r);if(o.status)return o;var s=ne()(e),i=[n.id,a.id].map(function(p){return p.toString().split("-")}),u=D()(i,2),m=u[0],b=u[1];return m.length!==b.length?{data:s,status:!1}:{data:$e(s,m,b,r),status:!0}},Ve=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"children",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"treeKey",r=function o(s,i,u){var m=u!==void 0?"".concat(u,"-").concat(i):String(i);s[a]=m;var b=s[n];Array.isArray(b)&&s[n].forEach(function(p,x){o(p,x,m)})};return e.forEach(function(o,s){r(o,s)}),e},Kt=["DragHandle","dragSortKey"],Ge=(0,c.createContext)({handle:null}),Zt=function(e){var n=(0,je.nB)({id:e.id}),a=n.attributes,r=n.listeners,o=n.setNodeRef,s=n.transform,i=n.transition,u=v()({transform:wt.ux.Transform.toString(s),transition:i},e==null?void 0:e.style),m=e.DragHandle,b=e.dragSortKey,p=be()(e,Kt);if(b){var x=[];return c.Children.forEach(p.children,function(y,j){if(y.key===b){var h,C;x.push((0,t.jsx)(Ge.Provider,{value:{handle:(0,t.jsx)(m,v()(v()({rowdata:y==null||(h=y.props)===null||h===void 0?void 0:h.record,index:y==null||(C=y.props)===null||C===void 0?void 0:C.index},r),a))},children:y},y.key||j));return}x.push(y)}),(0,t.jsx)("tr",v()(v()({},p),{},{ref:o,style:u,children:x}))}return(0,t.jsx)("tr",v()(v()(v()({},p),{},{ref:o,style:u},a),r))},Bt=c.memo(function(l){var e=Object.assign({},(Ce()(l),l)),n=(0,c.useContext)(Ge),a=n.handle;return a?(0,t.jsx)("td",v()(v()({},e),{},{children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[a," ",e.children]})})):(0,t.jsx)("td",v()({},e))}),Ht=function(e){return(0,t.jsx)("tbody",v()({},e))};function Mt(l){var e=l.dataSource,n=e===void 0?[]:e,a=l.onDragSortEnd,r=l.DragHandle,o=l.dragSortKey,s=l.sortType,i=l.childrenColumnName,u=l.treeKeyName,m=(0,J.Dy)((0,J.VT)(J.we),(0,J.VT)(J.MA));function b(h){var C,f=h.active,S=h.over;if(!(!(S!=null&&(C=S.id)!==null&&C!==void 0&&C.toString())||f.id===(S==null?void 0:S.id))){var k=Tt(n,f,S);if(k.status){a==null||a(k.data,k.status);return}s==="freeSort"?k=Ot(n,f,S,i):s==="groupSort"?k=Pt(n,f,S,i):s==="treeSort"&&(k=de(n,f,S,i)),a==null||a(k.data,k.status)}}var p=(0,ye.J)(function(h){return(0,t.jsx)(je.Fo,{items:At(n,i,u),strategy:je.qw,children:(0,t.jsx)(Ht,v()({},h))})}),x=(0,ye.J)(function(h){var C,f=Object.assign({},(Ce()(h),h)),S=Ye(n,i,function(k){var F;return k[(F=l.rowKey)!==null&&F!==void 0?F:"index"]===f["data-row-key"]});return(0,t.jsx)(Zt,v()({id:S[u],dragSortKey:o,DragHandle:r},f),S[(C=l.rowKey)!==null&&C!==void 0?C:"index"])}),y=l.components||{};if(o){var j;y.body=v()(v()({},((j=l.components)===null||j===void 0?void 0:j.body)||{}),{},{wrapper:p,row:x,cell:Bt})}return{DndContext:function(C){return(0,t.jsx)(J.LB,{sensors:m,collisionDetection:J.pE,onDragEnd:b,children:C.children})},components:y}}var Rt=d(7906),$t=["dataSource","defaultData","onDataSourceChange","onLoad","rowKey","dragSortKey","onDragSortEnd","dragSortHandlerRender","sortType","childrenColumnName","treeKeyName"],Vt=function(e){var n,a=e.dataSource,r=e.defaultData,o=e.onDataSourceChange,s=e.onLoad,i=e.rowKey,u=e.dragSortKey,m=e.onDragSortEnd,b=e.dragSortHandlerRender,p=e.sortType,x=p===void 0?"default":p,y=e.childrenColumnName,j=y===void 0?"children":y,h=e.treeKeyName,C=h===void 0?"treeKey":h,f=be()(e,$t),S=(0,Dt.Z)(function(){return Ve(r||[])},{value:Ve(a),onChange:o}),k=D()(S,2),F=k[0],A=k[1],M=function(){var T=Te()(le()().mark(function H(Z){return le()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return A(Z),O.abrupt("return",s==null?void 0:s(Z));case 2:case"end":return O.stop()}},H)}));return function(Z){return T.apply(this,arguments)}}(),Y=(0,c.useMemo)(function(){return function(T){var H=Object.assign({},(Ce()(T),T)),Z=(0,t.jsx)(Rt.Z,v()(v()({},H),{},{className:"habit-drag-sort-table-icon"})),N=b?b(T==null?void 0:T.rowdata,T==null?void 0:T.index,H):Z;return(0,t.jsx)(t.Fragment,{children:N})}},[]),W=Mt({dataSource:F==null?void 0:F.slice(),dragSortKey:u,onDragSortEnd:m,components:e.components,rowKey:i,DragHandle:Y,sortType:x,childrenColumnName:j,treeKeyName:C}),$=W.components,G=W.DndContext;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(Et.Z,v()(v()({},f),{},{columns:(n=f.columns)===null||n===void 0?void 0:n.map(function(T){return(T.dataIndex===u||T.key===u)&&(T.render||(T.render=function(){return null})),T}),rowKey:i,onLoad:M,dataSource:F,onDataSourceChange:o,components:$,tableViewRender:function(H,Z){return(0,t.jsx)(G,{children:Z})}}))})},ze=function(e){var n=e.className,a=n===void 0?"":n,r=e.hourClassName,o=r===void 0?"":r;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("ul",{className:a,children:[(0,t.jsx)("li",{children:"00:00 - 06:00"}),(0,t.jsx)("li",{children:"06:00 - 12:00"}),(0,t.jsx)("li",{children:"12:00 - 18:00"}),(0,t.jsx)("li",{children:"18:00 - 24:00"})]}),(0,t.jsx)("ul",{className:o,children:Array.from({length:24}).fill(void 0).map(function(s,i){return(0,t.jsx)("li",{children:i},i)})})]})},We=d(54844),Gt=function(e){var n=e.options,a=n===void 0?{}:n,r=e.events,o=e.content,s=(0,c.useState)(),i=D()(s,2),u=i[0],m=i[1],b=(0,c.useState)(),p=D()(b,2),x=p[0],y=p[1];return(0,c.useEffect)(function(){if(x){var j=new We.ZP(v()({container:x,rootContainer:null,dragContainer:x,boundContainer:x,selectableTargets:["li"],selectByClick:!0,selectFromInside:!0,continueSelect:!1,toggleContinueSelect:"shift",keyContainer:window,hitRate:0},a));m(j)}},[x]),(0,c.useEffect)(function(){if(u&&r){var j=Object.keys(r);j.forEach(function(h){u.on(h,r[h])})}},[u,r]),(0,t.jsxs)("div",{className:"habit-selecto",children:[(0,t.jsx)(ze,{className:"habit-selecto-split",hourClassName:"habit-selecto-hour"}),(0,t.jsx)("ul",{className:"habit-selecto-cont",ref:y,children:o})]})},zt=function(){return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("ul",{className:"habit-selecto-week-left",children:[(0,t.jsx)("li",{className:"habit-selecto-week-title",children:"\u661F\u671F"}),(0,t.jsx)("li",{children:"\u4E00"}),(0,t.jsx)("li",{children:"\u4E8C"}),(0,t.jsx)("li",{children:"\u4E09"}),(0,t.jsx)("li",{children:"\u56DB"}),(0,t.jsx)("li",{children:"\u4E94"}),(0,t.jsx)("li",{children:"\u516D"}),(0,t.jsx)("li",{children:"\u65E5"})]})})},Wt=function(e){var n=e.options,a=n===void 0?{}:n,r=e.events,o=e.className,s=o===void 0?"":o,i=e.style,u=e.render,m=(0,c.useState)(),b=D()(m,2),p=b[0],x=b[1],y=(0,c.useState)(),j=D()(y,2),h=j[0],C=j[1];return(0,c.useEffect)(function(){if(h){var f=new We.ZP(v()({container:h,rootContainer:null,dragContainer:h,boundContainer:h,selectableTargets:["li"],selectByClick:!0,selectFromInside:!0,continueSelect:!1,toggleContinueSelect:"shift",keyContainer:window,hitRate:0},a));x(f)}},[h]),(0,c.useEffect)(function(){if(p&&r){var f=Object.keys(r);f.forEach(function(S){p.on(S,r[S])})}},[p,r]),(0,t.jsxs)("div",{style:i,className:"habit-selecto-week ".concat(s),children:[(0,t.jsx)(zt,{}),(0,t.jsxs)("div",{className:"habit-selecto-week-right",children:[(0,t.jsx)(ze,{className:"habit-selecto-week-split",hourClassName:"habit-selecto-week-hour"}),(0,t.jsx)("ul",{className:"habit-selecto-week-cont",ref:C,children:Array.from({length:7}).fill(null).map(function(f,S){return(0,t.jsx)(c.Fragment,{children:u(S)},S)})})]})]})};function Le(l,e,n){var a=e<0?l.length+e:e;if(a>=0&&a<l.length){var r=n<0?l.length+n:n,o=l.splice(e,1),s=D()(o,1),i=s[0];l.splice(r,0,i)}}function ve(l){var e=l.array,n=l.fromIndex,a=l.toIndex,r=ne()(e);return Le(r,n,a),r}var Ye=function l(e,n,a){if(!Array.isArray(e))return null;for(var r=0;r<e.length;r++){var o=e[r];if(a(o,r,e))return o;var s=o[n];if(Array.isArray(s)){var i=l(s,n,a);if(i)return i}}return null}}}]);
