(self.webpackChunk_ddbor_habit=self.webpackChunk_ddbor_habit||[]).push([[841],{8841:function(H,re,r){"use strict";r.r(re),r.d(re,{HabitColumnSetting:function(){return Ke},HabitMultipleSelect:function(){return nt},HabitRangePicker:function(){return Be},groupHabitColumns:function(){return ye},habitColumnsCopy:function(){return Q},habitSortColumns:function(){return q},sortGroupHabitColumns:function(){return ke}});var ae=r(57213),s=r.n(ae),G=r(54306),d=r.n(G),V=r(58172),J=r(2514),T=r(60670),oe=r(76795),Ee=r(62006),be=r(97578),Se=r(64230),a=r(85170),Oe=r(74637),y=r.n(Oe),e=r(43010),fe=function(){return[{label:"\u4ECA\u65E5",value:[y()(),y()()]},{label:"\u6628\u65E5",value:[y()().subtract(1,"d"),y()().subtract(1,"d")]}]},Be=function(t){var n=t.value,v=t.popoverProps,C=t.buttonProps,f=t.presetsButtonProps,u=t.subtmitButtonProps,j=t.cancelButtonProps,h=t.presets,B=t.startDatePickerProps,I=t.endDatePickerProps,W=t.format,A=W===void 0?"YYYY-MM-DD":W,k=t.compared,Z=t.onChange,E=(0,a.useState)(["",""]),z=d()(E,2),i=z[0],F=z[1],O=(0,a.useState)(n),M=d()(O,2),c=M[0],N=M[1],_=(0,a.useState)(["",""]),L=d()(_,2),X=L[0],$=L[1],se=(0,a.useState)(!1),K=d()(se,2),Y=K[0],b=K[1],m=(0,a.useMemo)(function(){return typeof k=="boolean"},[k]),me=(0,a.useState)(""),de=d()(me,2),te=de[0],ve=de[1],ge=(0,a.useState)(!1),he=d()(ge,2),U=he[0],pe=he[1];(0,a.useEffect)(function(){pe(m?k:null)},[k,m]);var g=(0,a.useMemo)(function(){return m&&!k},[m,k]),l=(0,a.useMemo)(function(){return m&&!U},[m,U]),P=(0,a.useMemo)(function(){return Y?180:0},[Y]),x=(0,a.useMemo)(function(){var o,p;if(m){var R,xe;return[((R=fe().find(function(ne){return y()(ne.value[0]).isSame(n[0],"d")}))===null||R===void 0?void 0:R.label)||i[0],g?"":((xe=fe().find(function(ne){return y()(ne.value[0]).isSame(n[1],"d")}))===null||xe===void 0?void 0:xe.label)||i[1]]}if(te)return[te,""];var Ae=(o=h||[])===null||o===void 0||(p=o.concat(fe()).find(function(ne){return y()(ne.value[0]).isSame(n[0],"d")&&y()(ne.value[1]).isSame(n[1],"d")}))===null||p===void 0?void 0:p.label;return[Ae||i[0],Ae?"":i[1]]},[n,h,g,m,i,te]),w=(0,a.useMemo)(function(){return{textAlign:x[1]?"center":"left"}},[x]),D=(0,a.useCallback)(function(o){return o?l?o>y()().endOf("d"):U?o>y()().endOf("d")||c[1]&&o.isSame(c[1],"d"):c[1]&&o>c[1]:!1},[c[1],l]),ee=(0,a.useCallback)(function(o){return o?U?o>y()().endOf("d")||c[0]&&o.isSame(c[0],"d"):c[0]&&o<c[0]||o>y()().endOf("d"):!1},[c[0]]);(0,a.useEffect)(function(){N(n);var o=[y()(n[0]).format(A),y()(n[1]).format(A)];F(o),$(o)},[n]);var ie=function(p,R){N([p,c[1]]),$([R,X[1]])},le=function(p,R){N([c[0],p]),$([X[0],R])},ue=function(p){b(p)},rt=function(){b(!1),Z==null||Z(c,X,U),ve(null)},at=function(p){N(p.value);var R=[y()(p.value[0]).format(A),y()(p.value[1]).format(A)];$(R),b(!1),Z==null||Z(p.value,R,U),ve(p==null?void 0:p.label)},ot=(0,a.useCallback)(function(){return h==null?void 0:h.map(function(o,p){return typeof o.label=="string"?(0,e.jsx)("div",{className:"habit-range-picker-popover-presets-item",children:(0,e.jsx)(T.ZP,s()(s()({type:"link",size:"small",style:{padding:0,textAlign:"left",width:"100%"},onClick:function(){return at(o)}},f),{},{children:o.label}))},p):o.label})},[h]);return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(oe.Z,s()(s()({trigger:"click",placement:"bottom",open:Y,getPopupContainer:function(p){return p},overlayInnerStyle:{padding:0}},v),{},{onOpenChange:ue,content:(0,e.jsxs)("div",{className:"habit-range-picker-popover-content",children:[(0,e.jsxs)("div",{className:"habit-range-picker-popover-head",children:[(0,e.jsxs)("div",{className:"habit-range-picker-popover-head-title",children:[(0,e.jsx)("div",{children:"\u9009\u62E9\u65E5\u671F:"}),m&&(0,e.jsxs)("div",{className:"habit-range-picker-popover-head-switch",children:[(0,e.jsx)("span",{children:"\u5BF9\u6BD4"}),(0,e.jsx)(Ee.Z,{size:"small",checked:!!U,onChange:function(p){return pe(p)}})]})]}),(0,e.jsxs)("div",{className:"habit-range-picker-popover-date",children:[(0,e.jsx)(be.Z,s()({showToday:!1,allowClear:!1,size:"small",value:c[0],disabledDate:D,onChange:ie},B)),(0,e.jsx)("span",{className:"habit-range-picker-popover-date-separator",children:"-"}),(0,e.jsx)(be.Z,s()(s()({showToday:!1,allowClear:!1,size:"small",placement:"bottomRight",value:c[1],disabledDate:ee,onChange:le},I),{},{disabled:l}))]})]}),(0,e.jsx)(Se.Z,{style:{margin:0}}),h&&h.length&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"habit-range-picker-popover-presets",children:[(0,e.jsx)("div",{className:"habit-range-picker-popover-presets-title",children:"\u5FEB\u6377\u65E5\u671F:"}),(0,e.jsx)("div",{className:"habit-range-picker-popover-presets-list",children:ot()})]}),(0,e.jsx)(Se.Z,{style:{margin:0}})]}),(0,e.jsxs)("div",{className:"habit-range-picker-popover-footer",children:[(0,e.jsx)(T.ZP,s()(s()({type:"primary",size:"small",style:{marginRight:"8px"}},u),{},{onClick:function(){return rt()},children:"\u786E\u5B9A"})),(0,e.jsx)(T.ZP,s()(s()({size:"small"},j),{},{onClick:function(){return b(!1)},children:"\u53D6\u6D88"}))]})]}),children:(0,e.jsx)("div",{className:"habit-range-picker",children:(0,e.jsx)(T.ZP,s()(s()({},C),{},{htmlType:"reset",onClick:function(){return b(!Y)},children:(0,e.jsxs)("div",{className:"habit-range-picker-button",children:[(0,e.jsx)(V.Z,{style:{color:"#999"}}),(0,e.jsxs)("div",{className:"habit-range-picker-button-text",children:[(0,e.jsx)("span",{className:"habit-range-picker-button-text-item",style:w,children:x[0]}),x[1]&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"habit-range-picker-button-text-separator",children:m?"\u5BF9\u6BD4":"-"}),(0,e.jsx)("span",{className:"habit-range-picker-button-text-item",style:w,children:x[1]})]})]}),(0,e.jsx)(J.Z,{style:{color:"#999",transform:"rotate(".concat(P,"deg)"),transition:"all 0.3s"}})]})}))})}))})},Ze=r(12342),we=r.n(Ze),Ce=r(35041),De=r(3124),je=r(19537),Te=r(12852),Fe=r(69189),ye=function(t){return t.reduce(function(n,v){var C=v.properties.groupName,f=v.properties.groupOrder;return n[C]||(n[C]={groupName:C,groupOrder:f,columns:[]}),n[C].columns.push(v),n},{})},ke=function(t){return Object.values(ye(t)).sort(function(n,v){return n.groupOrder-v.groupOrder})},Ne=function(t){return typeof t.order=="number"?t.order:1/0},q=function(t){return t.filter(function(n){return n.show}).sort(function(n,v){return Ne(n)-Ne(v)})},Q=function(t){return t.map(function(n){return s()({},n)})},Ie=(0,je.W8)(function(S){var t=S.value;return(0,e.jsx)("div",{className:"habit-column-setting-drag-item",style:{backgroundImage:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAUCAYAAACEYr13AAAAt0lEQVR4Ae3BQQ3EMAxE0d8MDRMKEUtGFMlESig0RtoiaA697ntXVU3bzUNSrrVuXlTVtN08JOWw3UAAYbs5sN1AAGG7Bx8NSQlsYEtKDiQlsIEtKfnjqqppu3lIyrXWzYuqmrabh6QcthsIIGw3B7YbCCBs9+CjISmBDWxJyYGkBDawJSV/XFU1bTcPSbnWunlRVdN285CUw3YDAYTt5sB2AwGE7R58NCQlsIEtKTmQlMAGtqT8AT13ZKKS1qIVAAAAAElFTkSuQmCC")'},children:(0,e.jsx)(e.Fragment,{children:t==null?void 0:t.title})})}),Me=(0,je.JN)(function(S){var t=S.children;return(0,e.jsx)("div",{className:"habit-column-setting-drag-box",children:t})}),Re=function(t){var n=t.dataSource,v=t.onSortEnd,C=(0,Te.J)(function(f){var u=f.oldIndex,j=f.newIndex;if(u!==j){var h=(0,Fe.q)({array:Q(n),fromIndex:u,toIndex:j});h.forEach(function(B,I){B.order=I}),v==null||v(h)}});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Me,{lockAxis:"y",lockToContainerEdges:!0,onSortEnd:C,children:n.map(function(f,u){return(0,e.jsx)(Ie,{index:u,value:f},f.key)})})})},ce=r(87862),He=r(17061),Ge=r(88440),ze={color:"#ccc",cursor:"pointer",fontSize:"14px",marginLeft:"2px",verticalAlign:"middle"},Pe=function(t){return t.every(function(n){return n.show})},Ye=function(t){return t.some(function(n){return n.show})&&!Pe(t)},Ve=function(t,n){return!n||typeof t!="string"?!1:t.includes(n)},Qe=function(t){var n=t.dataSource,v=t.filterTitle,C=t.max,f=C===void 0?1/0:C,u=t.sortColumns,j=u===void 0?[]:u,h=t.onChange,B=(0,a.useState)([]),I=d()(B,2),W=I[0],A=I[1],k=(0,a.useMemo)(function(){return j.length>=f},[f,j]);(0,a.useEffect)(function(){A(ke(Q(n)))},[n]);var Z=function(z,i){var F=z.target.checked,O=Q(n),M=j.length;i.forEach(function(c){if(!(F&&M>=f||c!=null&&c.disable)){var N=O.findIndex(function(_){return _.key===c.key});O[N].show=F,F?M++:delete O[N].order}}),h==null||h(O)};return(0,e.jsx)(e.Fragment,{children:W.map(function(E,z){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"habit-column-setting-left-cont-title",children:(0,e.jsx)(ce.Z,{indeterminate:Ye(E.columns),checked:Pe(E.columns),onChange:function(F){return Z(F,E.columns)},children:(0,e.jsx)("span",{className:"habit-column-setting-checkbox-label",children:E.groupName})})}),(0,e.jsx)("div",{className:"habit-column-setting-checkbox-list clearfix",children:E.columns.map(function(i){return(0,e.jsxs)("div",{className:"habit-column-setting-checkbox-item ".concat(Ve(i.title,v)?"habit-column-setting-checkbox-item-active":""),children:[(0,e.jsx)(ce.Z,{checked:i.show,disabled:i.disable||k&&!i.show,onChange:function(O){return Z(O,[i])},children:(0,e.jsx)("span",{className:"habit-column-setting-checkbox-label",children:i==null?void 0:i.title})}),i.description&&(0,e.jsx)(He.Z,{title:i.description,children:(0,e.jsx)(Ge.Z,{style:ze})})]},i.key)})})]},z.toString())})})},We=["columns","open","max","onOk","persistenceKey","persistenceType"],$e=Ce.Z.Search,Ke=function(t){var n=t.columns,v=t.open,C=t.max,f=t.onOk,u=t.persistenceKey,j=t.persistenceType,h=we()(t,We),B=h.onClose,I=(0,a.useState)([]),W=d()(I,2),A=W[0],k=W[1],Z=(0,a.useState)([]),E=d()(Z,2),z=E[0],i=E[1],F=(0,a.useState)(""),O=d()(F,2),M=O[0],c=O[1],N=(0,a.useRef)([]),_=(0,a.useState)([]),L=d()(_,2),X=L[0],$=L[1],se=(0,a.useState)(!0),K=d()(se,2),Y=K[0],b=K[1],m=(0,a.useMemo)(function(){return!u||!j||typeof window=="undefined"},[u,j]),me=(0,a.useCallback)(function(g){if(m)return g;var l=window[j];try{var P=l==null?void 0:l.getItem(u);if(P){var x=JSON.parse(P),w=Q(g);return w.forEach(function(D){var ee,ie,le,ue;D.show=(ee=x==null||(ie=x[D.key])===null||ie===void 0?void 0:ie.show)!==null&&ee!==void 0?ee:D.show,D.order=(le=x==null||(ue=x[D.key])===null||ue===void 0?void 0:ue.order)!==null&&le!==void 0?le:D.order}),w}}catch(D){console.warn(D)}return g},[u,j,m]),de=(0,a.useCallback)(function(g){if(!m){var l=window[j];try{var P=g.reduce(function(x,w){return x[w.key]={show:w.show,order:w.order},x},{});l==null||l.setItem(u,JSON.stringify(P))}catch(x){console.warn(x)}}},[u,j,m]),te=function(l,P){return l.map(function(x){var w=P.find(function(ee){return ee.key===x.key}),D=s()(s()({},x),{},{show:!!w});return w&&(D.order=w.order),D})};(0,a.useEffect)(function(){if(v){var g=n;N.current=g,b(!1),k(q(Q(N.current))),i(N.current)}},[v,n]),(0,a.useEffect)(function(){if(!v&&Y&&!m){var g=me(n);$(g),b(!1),f==null||f(te(g,q(Q(g))))}},[Y,m,v,n]);var ve=function(l){c(l)},ge=function(l){k(q(l)),i(l)},he=function(){k(q(Q(X))),i(X)},U=function(){var l=Q(N.current);l.forEach(function(P){P.disable||(P.show=!1,delete P.order)}),k(q(l)),i(l)},pe=function(l){var P=te(N.current,A);de(P),f==null||f(P),B==null||B(l)};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(De.Z,s()(s()({title:"\u9009\u62E9\u6570\u636E\u5B57\u6BB5",placement:"right",width:1e3,bodyStyle:{padding:"16px 24px",backgroundColor:"#f9f9f9"},footer:(0,e.jsxs)("div",{children:[(0,e.jsx)(T.ZP,{type:"primary",style:{marginRight:15},onClick:pe,children:"\u786E\u5B9A"}),(0,e.jsx)(T.ZP,{type:"default",onClick:B,children:"\u53D6\u6D88"})]}),open:v},h),{},{children:(0,e.jsxs)("div",{className:"habit-column-setting-body",children:[(0,e.jsxs)("div",{className:"habit-column-setting-left",children:[(0,e.jsx)("div",{className:"habit-column-setting-left-head",children:(0,e.jsx)($e,{placeholder:"\u641C\u7D22\u6570\u636E\u5B57\u6BB5",allowClear:!0,style:{width:200},onSearch:ve})}),(0,e.jsx)("div",{className:"habit-column-setting-left-cont",children:(0,e.jsx)(Qe,{max:C,sortColumns:A,dataSource:z,filterTitle:M,onChange:ge})})]}),(0,e.jsxs)("div",{className:"habit-column-setting-right",children:[(0,e.jsxs)("div",{className:"habit-column-setting-right-head",children:[(0,e.jsxs)("span",{className:"habit-column-setting-checkbox-label",children:["\u5DF2\u9009\uFF08",A.length," ",C?"/".concat(C):null,"\uFF09\u9879"]}),(0,e.jsx)("a",{className:"habit-column-setting-right-a",onClick:U,children:"\u6E05\u7A7A"}),(0,e.jsx)("a",{className:"habit-column-setting-right-a",onClick:he,children:"\u6062\u590D\u9ED8\u8BA4"})]}),(0,e.jsx)("div",{className:"habit-column-setting-right-alert",children:"\u62D6\u52A8\u4EE5\u4E0B\u5B57\u6BB5\u8FDB\u884C\u6392\u5E8F"}),(0,e.jsx)(Re,{dataSource:A,onSortEnd:function(l){return k(q(l))}})]})]})}))})},Ue=r(62417),Je=r(78685),Le=r(32269),Xe=r(45288),qe=r(55269),_e=r(28878),et=Ce.Z.Search,tt=Je.Z.useToken,nt=function(t){var n=t.popoverProps,v=t.buttonProps,C=t.searchProps,f=t.className,u=t.value,j=t.style,h=t.onChange,B=t.options,I=B===void 0?[]:B,W=t.buttonText,A=t.showSearch,k=A===void 0?!0:A,Z=(0,a.useState)(!1),E=d()(Z,2),z=E[0],i=E[1],F=(0,a.useState)(""),O=d()(F,2),M=O[0],c=O[1],N=(0,a.useMemo)(function(){return I.filter(function(b){return b.label.includes(M)})},[M,I]),_=(0,a.useState)(!1),L=d()(_,2),X=L[0],$=L[1],se=tt(),K=se.token,Y={color:K.colorTextQuaternary,fontSize:K.fontSizeIcon};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(oe.Z,s()(s()({open:z,onOpenChange:i,placement:"bottom",trigger:"click",overlayStyle:{width:250}},n),{},{content:(0,e.jsxs)(e.Fragment,{children:[!!k&&(0,e.jsx)(et,s()(s()({placeholder:"\u540D\u79F0\u641C\u7D22",className:"habit-multiple-select-search",allowClear:!0,size:"small"},C),{},{value:M,onChange:function(m){return c(m.target.value)}})),(0,e.jsx)(ce.Z.Group,{value:u,onChange:h,children:(0,e.jsx)(Le.Z,{gutter:[0,10],children:N.map(function(b){return(0,e.jsx)(Xe.Z,{span:24,children:(0,e.jsx)(ce.Z,{value:b.value,children:b.label})},b.value)})})}),!N.length&&(0,e.jsx)(qe.Z,{description:!1})]}),children:(0,e.jsx)(T.ZP,s()(s()({className:"habit-multiple-select-button ".concat(f),style:j},v),{},{onMouseEnter:function(){return $(!0)},onMouseLeave:function(){return $(!1)},children:(0,e.jsxs)("div",{className:"habit-multiple-select-button-content",children:[(0,e.jsx)("span",{children:W}),u!=null&&u.length?X?(0,e.jsx)(Ue.Z,{className:"habit-multiple-select-icon",style:Y,onClick:function(m){m.stopPropagation(),h==null||h([])}}):(0,e.jsx)(_e.Z,{className:"habit-multiple-select-icon",count:u==null?void 0:u.length,showZero:!0,size:"small",color:K.colorPrimary}):(0,e.jsx)(J.Z,{className:"habit-multiple-select-icon",style:Y})]})}))}))})}},12342:function(H,re,r){var ae=r(20006);function s(G,d){if(G==null)return{};var V=ae(G,d),J,T;if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(G);for(T=0;T<oe.length;T++)J=oe[T],!(d.indexOf(J)>=0)&&Object.prototype.propertyIsEnumerable.call(G,J)&&(V[J]=G[J])}return V}H.exports=s,H.exports.__esModule=!0,H.exports.default=H.exports},20006:function(H){function re(r,ae){if(r==null)return{};var s={},G=Object.keys(r),d,V;for(V=0;V<G.length;V++)d=G[V],!(ae.indexOf(d)>=0)&&(s[d]=r[d]);return s}H.exports=re,H.exports.__esModule=!0,H.exports.default=H.exports}}]);
